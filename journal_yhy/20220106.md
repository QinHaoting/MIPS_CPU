### 一、完成的任务

1. 实现加载存储指令

   1.1 修改OpenMIPS以实现加载存储指令

   1.1.1 修改译码阶段

   1.1.2 修改执行阶段

   1.1.3 修改访存阶段

   1.1.4 修改OpenMIPS顶层模块

   1.2 修改最小SOPC

   1.2.1 添加数据存储器RAM

   1.2.2 修改最小SOPC

### 二、 问题及解决措施

1. 问题描述：

   加载指令lw会在访存阶段从数据存储器读取数据，也就是在访存阶段才能写入通用寄存器$1的值，这个值是$1的最新值，此时紧接着的转移指令beq处于执行阶段，而beq在上一周期译码阶段时，就已经对寄存器$1与$2的值进行了比较，并判断是否转移，这个判断依据的寄存器$1的值不是lw指令加载得到的值，程序没有按照意图运行。

   ![image-20220108224648349](https://gitee.com/orange-mint/upload-image/raw/master/202201082253061.png)

   2. 措施：

      在译码阶段检查当前指令与上一条指令是否存在load相关，如果存在load相关，那么就让流水线的译码、取指阶段暂停，而执行、访存、回写阶段继续，相当于插入一个空指令，这样处于执行阶段的加载指令会继续运行，然后，流水线可以继续运行。

      ![image-20220108225025310](https://gitee.com/orange-mint/upload-image/raw/master/202201082253650.png)

      

      其中，将访存阶段的数据前推到译码阶段，这一点早已实现，所以需要增加的就是判断load相关，并在出现load相关时，暂停流水线。

      ![image-20220108225302423](https://gitee.com/orange-mint/upload-image/raw/master/202201082253576.png)

